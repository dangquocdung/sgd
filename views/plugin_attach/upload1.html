{{extend 'plugin_app/layout.html'}}
<script src="{{=URL(r=request,c='static',f='plugin_attach/fileuploader.js')}}" type="text/javascript"></script>
<link type="text/css" href="{{=URL(r=request,c='static',f='plugin_attach/fileuploader.css')}}" rel="stylesheet" />	

<script>
$(document).ready(function() { 
	var uploader_{{=request.args(0)}} = new qq.FileUploader({
		// pass the dom node (ex. $(selector)[0] for jQuery users)
		element: document.getElementById('file-uploader_{{=request.args(0)}}'),
		// path to server-side upload script
		action: '{{=URL(f="upload_callback",args=request.args)}}',
		record_id: '12345',
		sizeLimit: 15000000,
		minSizeLimit: 0,         
		allowedExtensions: ['xls','jpg', 'jpeg', 'pdf', 'txt','doc','docx','htm','html','xml','xmls', 'txt','ppt','png', 'gif'],
		// set to true to output server response to console
		debug: true,

		// events         
		// you can return false to abort submit
		onSubmit: function(id, fileName){},
		onProgress: function(id, fileName, loaded, total){},
		onComplete: function(id, fileName, responseJSON){},
		onCancel: function(id, fileName){},

		messages: {
			// error messages, see qq.FileUploaderBasic for content
			typeError: "{file} {{=T('has invalid extension.')}} {{=T('Only')}} {extensions} {{=T('are allowed.')}}",
			sizeError: "{file} {{=T('is too large, maximum file size is')}} {sizeLimit}.",
			minSizeError: "{file} {{=T('is too small, minimum file size is')}} {minSizeLimit}.",
			emptyError: "{file} {{=T('is empty, please select files again without it.')}}",
			onLeave: "{{=T('The files are being uploaded, if you leave now the upload will be cancelled.')}}"                         
		},
		showMessage: function(message){ alert(message); }        
	});
});        
</script>

<div id="file-uploader_{{=request.args(0)}}">
<noscript><p>{{=T('Please enable JavaScript to use file uploader.')}}</p></noscript>
</div>

<div id='file_attachment'>
{{=content}}
</div>